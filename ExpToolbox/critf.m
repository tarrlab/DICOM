function fval = critf(p,df1,df2)%CRITF calculates the critical F value to produce given probability%    usage: fval = critf(p,df1,df2)%    returns: fval = F value%    %    adapted from |stat (c) 1981 Gary Perlman%	StatToolbox. See also POF, POT% This software may be copied freely provided:  (1) it is not used for% personal or material gain, and (2) this notice accompanies each copy.% ALGORITHM% 	Begin with upper and lower limits for F values (maxf and minf)% 	set to extremes.  Choose an f value (fval) between the extremes.% 	Compute the probability of the f value.  Set minf or maxf, based% 	on whether the probability is less than or greater than the% 	desired p.  Continue adjusting the extremes until they are% 	within F_EPSILON of each other.F_EPSILON = 0.000001; % accuracy of critf approximationmaxf = 9999.0; % maximum F ratiominf = 0.0; % minimum F ratioif p <= 0.0 | p >= 1.0	fval = 0.0;	return;endfval = 1.0 / p; % the smaller the p, the larger the Fwhile abs(maxf - minf) > F_EPSILON	if pof(fval, df1, df2) < p	% F too large		maxf = fval;	else                              	% F too small		minf = fval;	end	fval = (maxf + minf) * 0.5;end